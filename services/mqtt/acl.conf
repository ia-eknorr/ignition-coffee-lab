%% EMQX 5.x ACL Configuration for Ignition Coffee Lab
%% ====================================================
%% Format: {Permission, Who, Action, Topics}.
%% Permission: allow | deny
%% Who: all | {username, "name"} | {clientid, "id"} | {ipaddr, "ip"}
%% Action: subscribe | publish | all
%% Topics: list of topic filters

%% ─────────────────────────────────────────────────────────────────────
%% Pico W Devices
%% ─────────────────────────────────────────────────────────────────────
%% Allow Pico to publish temperature and status to its topics
{allow, {clientid, "icl_roast_monitor_pico_w"}, publish, ["icl/roast_monitor/pico01/temperature"]}.
{allow, {clientid, "icl_roast_monitor_pico_w"}, publish, ["icl/roast_monitor/pico01/status"]}.

%% Allow Pico to subscribe to commands (future: remote control)
{allow, {clientid, "icl_roast_monitor_pico_w"}, subscribe, ["icl/roast_monitor/pico01/commands"]}.

%% ─────────────────────────────────────────────────────────────────────
%% Ignition Gateway (MQTT Engine)
%% ─────────────────────────────────────────────────────────────────────
%% Allow Ignition to subscribe to all ICL topics
{allow, {clientid, "ignition_mqtt_engine"}, subscribe, ["icl/#"]}.

%% Allow Ignition to publish commands to devices
{allow, {clientid, "ignition_mqtt_engine"}, publish, ["icl/+/+/commands"]}.

%% ─────────────────────────────────────────────────────────────────────
%% System Topics
%% ─────────────────────────────────────────────────────────────────────
%% Allow dashboard/monitoring to read system stats
{allow, all, subscribe, ["$SYS/#"]}.

%% ─────────────────────────────────────────────────────────────────────
%% Development: Allow all (anonymous access)
%% Comment out for production!
%% ─────────────────────────────────────────────────────────────────────
{allow, all, all, ["#"]}.

%% ─────────────────────────────────────────────────────────────────────
%% Default Deny (uncomment for production)
%% ─────────────────────────────────────────────────────────────────────
%% {deny, all, all, ["#"]}.
